from openai import OpenAI
import os
from dotenv import load_dotenv

# Load environment variables (make sure .env file has OPENAI_API_KEY)
load_dotenv()

def summarize_text(input_text: str) -> str:
    """Summarize text using OpenAI GPT model."""
    client = OpenAI(api_key=os.getenv("OPENAI_API_KEY"))

    prompt = f"""
            You are given a full transcript generated from a podcast speaker‚Äôs voice. 
            Your task is to transform this transcript into a shorter 5‚Äì10 minute narrative script while preserving the speaker‚Äôs natural tone, intent, and style.

            Follow these rules:

            1. Treat the input as the speaker‚Äôs own words. Keep the speaker‚Äôs original sentences and phrasing wherever possible.
            2. Remove unnecessary parts: filler words, repetition, long pauses, unrelated tangents, and any low-value conversations.
            3. Maintain the speaker‚Äôs flow and personality. It should feel like the speaker is still talking.
            4. When presenting important statements or ideas, introduce them naturally with:
            ‚ÄúThe speaker said‚Ä¶‚Äù or ‚ÄúThe speaker explained‚Ä¶‚Äù
            5. You may create short connecting lines between sections to ensure smooth flow, but they must sound natural and should never mention that they are added or generated.
            6. Do NOT produce a high-level summary. Instead, create a shorter narrative version of the actual content, preserving real wording and real meaning.
            7. Do NOT add new ideas, interpretations, or commentary that were not in the transcript.
            8. The final result should be a clean, continuous script suitable for text-to-speech voice generation.

            Here is the transcript to refine:

            {input_text}

            Now produce the refined narrative script.

        """

    response = client.responses.create(
        model="gpt-5",
        input=prompt,
        max_output_tokens=500,
        temperature=1.0
    )

    return response.output_text.strip()





if __name__ == "__main__":
    sample_text = """
    President Trump has announced that he, he is sending federal troops to the state of Oregon and to the city of Chicago. He's not yet sent federal troops to Oregon. There's a court fight that's way too complex and not that interesting to explain at the moment, look it up, that has prevented that. But National Guardsmen have arrived, mostly from Texas, in the state of Ch- uh, of Illinois, in Chicago, to force, the president says, that city to allow ICE, the immigration service, federal immigration officers, to do their job, to deport people h- who are breaking federal law, illegal aliens. And the Mayor of Chicago and the Governor of Illinois have said multiple times, "We do not follow federal immigration law in the state of Illinois and the city of Chicago." So, the president is forcing this issue, they're in violation of the law, he says he's working to uphold the law. Here is the response of J.B. Pritzker, who is the longtime, th- six years now, I think, governor of Chicago, to the president's deployment of National Guard troops to Illinois. Watch. What I know is, in the early days of the Nazi regime, they started slowly but surely taking a pe- away people's rights. And what we're seeing now is the very same thing. They've gone into cities now with the military. Think about that. In your lifetime, have you ever seen anything like that? Where the president of the United States is sending military or troops dressed as military, ICE and CBP, in camouflage, with automatic weapons, into our major cities. It's wrong. (laughs) He's- he's such a buffoon. So demented is the Democratic Party, that guy thinks he's gonna be president. "Have you ever seen this before? Has it ev- In American history, has there ever been a single instance of some Nazi in the White House sending troops into a state to uphold federal..." It's never happened before. It's never happened before, except it's happened like a million times and it's been celebrated almost every single time beginning at least in September of 1957, three years after the Brown versus Board of Education decision came down from, from the Supreme Court banning segregation in public schools in the United States. And in the state of Arkansas, in the capital city, Little Rock, Central High School, a high school, was not following this Supreme Court decision. And so, Dwight David Eisenhower, General Eisenhower, commander of American troops in Europe during World War II, the President of the United States, sent the 101st Airborne to Central High School. The 101st Airborne, not like 300 fat guardsmen from San Antonio, but the 101st Airborne, with M1s, to a high school. And then he left his vacation and he went on television to explain why he did it. And remarkably, thanks to the internet, we have the tape. Here's part of it. In that city, under the leadership of demagogic extremists, disorderly mobs have deliberately prevented the carrying out of proper orders from a federal court. Local authorities have not eliminated that violent opposition. And under the law, I yesterday issued a proclamation calling upon the mob to disperse. Yep. That was General, then President, Eisenhower, September 1957, sending the 101st Airborne to Central High School in Little Rock, Arkansas, because the racist governor, Orval Faubus, wouldn't let Black students attend a white high school. And every liberal in America applauded. "Shoot them!" There was one girl in the crowd that day who smirked or scowled at one of the young Black ladies being escorted into the school, and she shouldn't have done that. It was cruel, obviously. But it wrecked her life. That picture, which ran in the Arkansas Democrat September of 1957, wrecked her life, actually. She never got out from under that. And that's a measure of how strongly the media, the American establishment, and some of the public were behind the president. Look, it's a Supreme Court order. It's the law of the land. You can't disobey it or else we have mob rules. Someone's gonna rule, okay? It'll either be a dispassionate law that treats everybody equally or it will be an individual who plays favorites. So, your choice really is not between no law and law. That's not a choice. Your choice is between the rule of law or anarchy which leads to dictatorship. That's your choice. And Eisenhower, in- in an interesting speech, 13-minute-long speech, laid this all out, which is on YouTube, you should check it out. He explained why he did it, because it wasn't about simply desegregating a high school in Little Rock. It was about upholding the basis of the American judicial system, which is to say the basis of America itself, which is equal application of the law, fairness under the law. It's a nation of laws, not men. And he did that and it was roundly applauded and it worked, in some ways. Public education was totally destroyed nationally, but whatever. The rule of law was upheld. Five years later, noting what a popular move this was, apparently, his successor, John F. Kennedy, faced a pretty similar situation at the University of Mississippi in Oxford, Mississippi. It was, again, September 1962, and there was a lone Black student attempting to enroll. His name was James Meredith. He's still alive, he's 92 years old. He's a total right-winger, by the way, which is interesting. But he was trying to enroll and the school would not accept his application because he was Black.And so President Kennedy also sent the military to Ole Miss. How many did he send? President Trump has sent, mm, three to 500 guardsmen to Chicago, to a city of millions. President Kennedy sent 31,000 US soldiers, US Army soldiers to a campus of 6,000. Yeah. That's more than five armed soldiers per student. 31,000 American troops descended on the campus of Ole Miss in Oxford, Mississippi at the very end of September, early October 1962, and they shut it down. And they camped on the quad in tents, and they put tanks on the football field, and they put machine gun emplacements on the quad. Couple people were shot to death. And President Kennedy made, now a bit overkill, in fact, disgusting overkill, in fact, fascist overkill, b- but the point is, he was applauded for it, because there was a federal law emanating from, uh, Supreme Court decision and he was upholding it, in the same way that President Trump is currently attempting to, in a much less vigorous way, uphold federal immigration law, passed by the United States Congress, which is core to the country. Who lives here is the main question in any country. Who lives there? What is a country? It's the people who live there. And immigration law is the way that you regulate that. So if you don't control that, you're literally not a country. So that's not an optional law. That is a core law. And in the case of Chicago and Portland, but particularly Chicago, shameful, thousands, thousands of people are shot in Chicago every year. Whole parts of Chicago you can't go to. Not if you're like me, you can't. It's so racist and violent, you literally can't walk through parts of a city that you pay for as a federal taxpayer, as an American. You can't walk through it. Several years ago, you'll remember there was a huge debate in Europe, are there no-go zones in Paris? Are there parts where, you know, native born Parisians can't go? Where they're not welcome? "Oh, that's not true," they said, "That's not true." But of cour- ... uh, whether or not, of course it was true. But what's even more true is that that's the state of play in the United States, and has been for generations. Huge parts of a cit- ... huge p- ... you could walk all day through parts of a city that you actually can't walk through, because they're too dangerous for you. And Chicago is particularly, particularly disgraceful in its decline. And you don't have to guess about that. I'm gonna show you a video in just a second, but you don't have to guess. Look at the numbers. Look at the outflow from Chicago. Are people who were born in Chicago staying in Chicago? No, they're fleeing. Go to Southwest Florida. Go to dinner in Naples some night, and ask, "Anyone here from Illinois?" It's half the room. And they're grateful to be gone. That's how dystopian it is, on every level. Economically, primarily, but even on a more basic level, it's just too dangerous. "Oh, the freedoms we're losing." Really? What about my freedom to walk to the liquor store at midnight without getting killed? How about ta- ... my freedom to stop at a red light without getting shot? That's totally real. It's not fake. It's not racist to say that. The mayor of Chicago is an open racist. So irony of ironies, here you have a president sending troops facing down a recalcitrant, racist local official. That does sound like 1962, doesn't it? Except this time, the president in question is not getting accolades from The New York Times. He's being called a dictator. A dictator! But just to set the table here, to give a, to lay down the framework for what we're talking about, Chicago the city, what does Chicago look like? This is, th- this question's very much like everything else you talk about, trans surgeries, abortion. Whatever the topic is, the people promoting it never want you to see what it actually looks like. Just an idea. It's a right. It's a theoretical concept. No one wants to see what it looks like to cut someone's penis off and create a vagina with a knife. That's what it actually is. All right, so Chicago went ... what does Chicago actually look like? Well, here's what it looks like. (sirens) (crowd yelling) Get the fuck out of here! Get the fuck out of here! Get the fuck out of here! (crowd yelling) Fuck you! Fuck you! Fuck you! Fuck you! Back up! Back up! Back up! (crowd yelling) So what's interesting about those videos is, who's participating in the rioting and the violence there? There's the normal assortment of unhappy white young people make up the bulk of ANTIFA, make up the bulk of the Democratics Party, party's activist wing. All the little DSA kids. You know, the children of orthodontists from Great Deck who are, you know, reliving the glories of the '60s or whatever. The weird little polyamorous nihilist freaks who don't see any future for themselves economically, so just burn it down. I mean, very, very familiar to anyone who's watched this stuff over the years. A repulsive group, a dangerous group. A sad group, by the way. Y- you shouldn't have a lot of young people like that in a functioning country. They should be looking forward to a brighter future, getting married, having kids, doing something useful. Building something, not just destroying. But they're not. So that is recognizable. We've seen a lot of that over the past 10 years, and we're gonna see a lot more going forward, unfortunately. Unless someone gets ahold of this now. Thanks for watching our YouTube channel. We hope you'll subscribe to it, and by the way, you can hit the little bell on there and get notifications every time we produce a video. We hope you'll do that also.

    """

    print("\nüöÄ Running Test Summarizer...\n")
    summary = summarize_text(sample_text)

    print("\nüìù SUMMARY RESULT:\n")
    print(summary if summary else "‚ö†Ô∏è No summary returned!")